<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Cart - Scentify</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    <div class="logo">Scentify</div>
    <nav class="menu-right">
        <a href="home.html">Home</a>
        <a href="login.php">Login</a>
        <a href="Create account.html">Create Account
           
        </a>
    </nav>
</header>

<section class="cart-page" style="padding: 40px 60px;">
    <h2 style="color: #2B2B2B; font-size: 32px; margin-bottom: 20px;">Your Cart</h2>
    <ul id="cart-items" style="list-style: none; padding: 0; max-width: 600px;">
        <!-- items loaded by JS -->
    </ul>
    <button 
        onclick="clearCart()" 
        style="
            margin-top: 20px; 
            padding: 10px 25px; 
            background: #D4AF37; 
            color: white; 
            border: none; 
            border-radius: 30px; 
            cursor: pointer;
        ">
        Clear Cart
    </button>
    </section>

<footer id="contact">
    <h3>Contact Us</h3>
    <p>Email: support@scentify.com</p>
    <p>Phone: +216 123 456 789</p>
    <p>&copy; 2025 Scentify. All rights reserved.</p>
</footer>

<script>
function getCart(){ return JSON.parse(localStorage.getItem('cart')||'[]'); }
function saveCart(cart){ localStorage.setItem('cart', JSON.stringify(cart)); }

function renderCart() {
    const cart = getCart();
    const list = document.getElementById('cart-items');
    list.innerHTML = '';

    if (!cart || cart.length === 0) {
        list.innerHTML = '<li>Your cart is empty.</li>';
        updateCartCount();
        return;
    }

    let grandTotal = 0;

    cart.forEach((item, index) => {
        const subtotal = item.price * item.qty;
        grandTotal += subtotal;

        const li = document.createElement('li');
        li.style.listStyle = 'none';
        li.style.marginBottom = '12px';

        li.innerHTML = `
            <div style="display:flex; justify-content:space-between; align-items:center; background:#fff; padding:12px; border-radius:10px; box-shadow:0 2px 8px rgba(0,0,0,0.04);">
                <div style="flex:1">
                    <strong>${escapeHtml(item.name)}</strong>
                    <div style="font-size:0.9rem; color:#555;">Price: ${formatPrice(item.price)} | Subtotal: ${formatPrice(subtotal)}</div>
                </div>

                <div style="display:flex; align-items:center; gap:8px; margin-left:12px;">
                    <button onclick="changeQty(${index}, ${item.qty - 1})" style="padding:6px 10px;border-radius:6px;border:none;cursor:pointer;">âˆ’</button>
                    <input type="number" min="1" value="${item.qty}" onchange="changeQty(${index}, this.value)" style="width:54px; text-align:center; padding:6px; border-radius:6px; border:1px solid #ddd;">
                    <button onclick="changeQty(${index}, ${item.qty + 1})" style="padding:6px 10px;border-radius:6px;border:none;cursor:pointer;">+</button>
                    <button onclick="removeItem(${index})" class="cart-remove-btn">Remove</button>
                </div>
            </div>
        `;
        list.appendChild(li);
    });

    // show grand total
    const totalLi = document.createElement('li');
    totalLi.style.listStyle = 'none';
    totalLi.style.marginTop = '18px';
    totalLi.innerHTML = `<div style="text-align:right; font-weight:700; font-size:1.15rem;">Total: ${formatPrice(grandTotal)}</div>`;
    list.appendChild(totalLi);

    updateCartCount();
}

function changeQty(index, newQty) {
    const cart = getCart();
    newQty = Number(newQty);
    if (newQty <= 0) {
        // remove item if zero or less
        cart.splice(index, 1);
    } else {
        cart[index].qty = newQty;
    }
    saveCart(cart);
    renderCart();
}

function removeItem(index) {
    if (!confirm('Remove this item from cart?')) return;
    const cart = getCart();
    cart.splice(index, 1);
    saveCart(cart);
    renderCart();
}

function clearCart() {
    if (!confirm('Clear your entire cart?')) return;
    localStorage.setItem('cart', JSON.stringify([]));
    renderCart();
    updateCartCount();
}

function updateCartCount() {
    const el = document.getElementById('cart-count');
    if (!el) return;
    const cart = getCart();
    const total = cart.reduce((s, it) => s + it.qty, 0);
    el.textContent = total;
}

function formatPrice(n) {
    // format without forcing locale if you prefer:
    return (Number(n) || 0).toFixed(2) + ' DT';
}

function escapeHtml(text) {
    return String(text)
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;');
}

document.addEventListener('DOMContentLoaded', renderCart);
</script>


</body>
</html>
